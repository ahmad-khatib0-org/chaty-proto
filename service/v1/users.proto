syntax = "proto3";

package service.v1;

import "shared/v1/error.proto";

enum UserFlag {
  USER_FLAG_UNSPECIFIED = 0;
  USER_FLAG_SUSPENDED_UNTIL = 1;
  USER_FLAG_DELETED = 2;
  USER_FLAG_BANNED = 4;
  USER_FLAG_SPAM = 8;
}

message UsersCreateRequest {
  string email = 1;
  string password = 2;
  string username = 3;
}

message UsersCreateResponse {
  oneof response {
    UsersCreateResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersCreateResponseData {
  string message = 1;
}

message UsersLoginRequest {
  string email = 1;
  string password = 2;
  string mfa = 3;
  string login_challenge = 4;
}

message UsersLoginResponse {
  oneof response {
    UsersLoginResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersLoginResponseData {
  string redirect_to = 1;
}

message UsersEmailConfirmationRequest {
  string token = 1;
}

message UsersEmailConfirmationResponse {
  oneof response {
    UsersEmailConfirmationResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersEmailConfirmationResponseData {
  string message = 1;
}

message UsersForgotPasswordRequest {
  string email = 1;
}

message UsersForgotPasswordResponse {
  oneof response {
    UsersForgotPasswordResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersForgotPasswordResponseData {
  string message = 1;
}

message UsersResetPasswordRequest {
  string token = 1;
  string password = 2;
  string password_confirmation = 3;
}

message UsersResetPasswordResponse {
  oneof response {
    UsersResetPasswordResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersResetPasswordResponseData {
  string message = 1;
}
