syntax = "proto3";

package service.v1;

import "shared/v1/error.proto";

message User {
  string id = 1; // ulid
  string username = 2; // 64 char
  string email = 3; // 255 char
  string password = 4;
  optional string display_name = 5; // 64 char
  optional uint32 badges = 6;
  optional string status_text = 7; // 510 char
  optional UserStatus status_presence = 8; // 32 char
  optional string profile_content = 9; // text
  optional string profile_background_id = 10; // ulid (26 chars) Reference to files collection
  bool privileged = 11;
  optional uint64 suspended_until = 12;
  uint64 created_at = 13; // unix timestamp miliseconds
  uint64 updated_at = 14; // unix timestamp miliseconds
  bool verified = 15;
}

enum UserStatus {
  USER_STATUS_ONLINE = 0;
  USER_STATUS_IDLE = 1;
  USER_STATUS_FOCUS = 2;
  USER_STATUS_BUSY = 3;
  USER_STATUS_INVISIBLE = 4;
}

enum UserFlag {
  USER_FLAG_UNSPECIFIED = 0;
  USER_FLAG_SUSPENDED_UNTIL = 1;
  USER_FLAG_DELETED = 2;
  USER_FLAG_BANNED = 4;
  USER_FLAG_SPAM = 8;
}

message UserCreateRequest {
  string email = 1;
  string password = 2;
  string username = 3;
}

message UserCreateResponse {
  oneof response {
    UserCreateResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UserCreateResponseData {}

message UsersLoginRequest {
  string email = 1;
  string password = 2;
  string mfa = 3;
  string login_challenge = 4;
}

message UsersLoginResponse {
  oneof response {
    UsersLoginResponseData data = 1;
    shared.v1.AppError error = 2;
  }
}

message UsersLoginResponseData {
  string message = 1;
}
